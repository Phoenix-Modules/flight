{"version":3,"file":"module.js","sources":["../../src/services/chatMessageService.js","../../src/services/actorService.js","../../src/constants/moduleData.js","../../src/constants/settings.js","../../src/constants/images.js","../../src/constants/features.js","../../src/services/settingsService.js","../../src/services/tokenService.js","../../src/services/flightService.js","../../src/compendium/flightFeatures.js","../../src/services/dataService.js","../../src/module.js"],"sourcesContent":["export async function getItemFromChatMessage(chatMessage) {\r\n    const itemId = chatMessage?.flags?.dnd5e?.use?.itemUuid;\r\n    if(!itemId) {\r\n        console.warn(\"cannot get item from chat message!\");\r\n        return;\r\n    }\r\n    return await fromUuid(itemId);\r\n}\r\n\r\nexport async function getActorFromChatMessage(chatMessage) {\r\n    const actorId = chatMessage?.speaker?.actor;\r\n    if(!actorId) {\r\n        console.warn(\"Cannot get actor from chat message!\");\r\n        return;\r\n    }\r\n    return await fromUuid(`Actor.${actorId}`);\r\n}\r\n\r\nexport async function getCurrentSceneTokenFromChatMessage(chatMessage) {\r\n    const tokenId = chatMessage?.speaker?.token;\r\n    if(!tokenId) {\r\n        console.warn(\"There is no token for the initiator of this chat message!\");\r\n        return;\r\n    }\r\n    const searchResult = game.scenes.active.collections.tokens.search(tokenId);\r\n    if(searchResult.length === 0) {\r\n        console.warn(\"There is no token for the initiator of this chat message in the active scene!\");\r\n        return;\r\n    }    \r\n    return searchResult[0];    \r\n}\r\n\r\n\r\n","export async function addEffectIfMissing(actor, effectData) {\r\n    const currentEffect = actor.effects.find(x => x.name === effectData.label);\r\n    if(currentEffect) return false;\r\n    await actor.createEmbeddedDocuments(\"ActiveEffect\", [effectData]);\r\n    return true;\r\n}\r\n\r\nexport async function deleteEffectIfExists(actor, effectName) {\r\n    const existingEffect = actor.effects.find(x => x.name === effectName);\r\n    if (!existingEffect) return false;    \r\n    await actor.deleteEmbeddedDocuments(\"ActiveEffect\", [existingEffect.id]);\r\n    return true;\r\n}\r\n\r\nexport async function hasEffect(actor, effectName) {\r\n    const existingEffect = actor.effects.find(x => x.name === effectName);\r\n    return existingEffect !== undefined;\r\n}","export const moduleData = {\r\n    imagesFolder: \"/modules/phoenix-modules-flight/images\",\r\n    moduleName: \"phoenix-modules-flight\",\r\n    featurePack: \"flight-features\",\r\n    macroPack: \"flight-macros\"\r\n}","export const Settings = {\r\n    FlightHeightKey: \"maxFlightHeight\",\r\n    IncrementKey: \"heightIncrement\",\r\n    AcAdjustmentKey: \"acAdjustment\",\r\n    ActionCostKey: \"costsAction\",\r\n    TokenScaleKey: \"scaleToken\"\r\n}\r\n\r\nexport default Settings;","import { moduleData } from \"./moduleData\";\r\n\r\nexport const Images = {\r\n    ModuleBanner: `${moduleData.imagesFolder}/Module Banner.png`,\r\n    Flying: `${moduleData.imagesFolder}/Skill_Fly.png`,\r\n    Land: `${moduleData.imagesFolder}/Skill_Land.png`,\r\n    Raise: `${moduleData.imagesFolder}/Skill_Plus.png`,\r\n    Lower: `${moduleData.imagesFolder}/Skill_Minus.png`\r\n}\r\n\r\nexport default Images;","import Images from \"./images\";\r\n\r\nexport const Features = {\r\n    FlyingLabel: \"Take Flight\",\r\n    FlyingImage: Images.Flying,\r\n    RaiseLabel: \"Fly Higher\",\r\n    RaiseImage: Images.Raise,\r\n    LowerLabel: \"Fly Lower\",\r\n    LowerImage: Images.Lower,\r\n    LandLabel: \"Land\",\r\n    LandImage: Images.Land\r\n}\r\n\r\nexport default Features;","import {moduleData} from \"../constants/moduleData\";\r\nimport Settings from \"../constants/settings\";\r\nimport Features from \"../constants/features\";\r\n\r\nexport async function registerSettings() {\r\n    game.settings.register(moduleData.moduleName, Settings.FlightHeightKey, {\r\n        name: 'Max Flight Height',\r\n        hint: 'The maximum height (in feet) that a character can fly.',\r\n        scope: 'world', \r\n        config: true, \r\n        type: Number, \r\n        default: 100, \r\n        restricted: true, \r\n        onChange: value => {\r\n            console.log(`Max flight height set to ${value}`);\r\n        }\r\n    });\r\n\r\n    game.settings.register(moduleData.moduleName, Settings.IncrementKey, {\r\n        name: 'Raise/Lower Increment',\r\n        hint: `The increment (in feet) that a character moves when using the ${Features.RaiseLabel}/${Features.LowerLabel} feature.`,\r\n        scope: 'world',\r\n        config: true,\r\n        type: Number,\r\n        default: 5,\r\n        restricted: true,\r\n        onChange: value => {\r\n            console.log(`Height increment set to ${value}`);\r\n        }\r\n    });\r\n\r\n    game.settings.register(moduleData.moduleName, Settings.AcAdjustmentKey, {\r\n        name: 'Adjust AC when flying',\r\n        hint: 'How much AC (positive or negative) to adjust when in flying state',\r\n        scope: 'world',\r\n        config: true,\r\n        type: Number,\r\n        default: -5,\r\n        restricted: true,\r\n        onChange: value => {\r\n            console.log(`AC adjustment set to ${value}`);\r\n        }\r\n    });\r\n\r\n    game.settings.register(moduleData.moduleName, Settings.TokenScaleKey, {\r\n        name: 'Scale Token with Height',\r\n        hint: 'Scale the token bigger or smaller depending on height',\r\n        scope: 'world',\r\n        config: true,\r\n        type: Boolean,\r\n        default: true,\r\n        restricted: true,\r\n        onChange: value => {\r\n            console.log(`AC adjustment set to ${value}`);\r\n        }\r\n    });\r\n}\r\n\r\n\r\nexport function getMaxFlightHeightValue() {\r\n    return game.settings.get(moduleData.moduleName, Settings.FlightHeightKey);\r\n}\r\n\r\n\r\nexport function getIncrementValue() {\r\n    return game.settings.get(moduleData.moduleName, Settings.IncrementKey);\r\n}\r\n\r\nexport function getAcAdjustmentValue() {\r\n    return game.settings.get(moduleData.moduleName, Settings.AcAdjustmentKey);\r\n}","\r\nexport async function scaleToken(token, elevation) {\r\n    const scaleValue = elevation * 0.01;\r\n    await token.document.update({ texture: { scaleX: 1 + scaleValue, scaleY: 1 + scaleValue}});   \r\n}","import {\r\n    getActorFromChatMessage,\r\n    getCurrentSceneTokenFromChatMessage,\r\n    getItemFromChatMessage\r\n} from \"./chatMessageService\";\r\nimport {addEffectIfMissing, deleteEffectIfExists, hasEffect} from \"./actorService\";\r\nimport {getAcAdjustmentValue, getIncrementValue, getMaxFlightHeightValue} from \"./settingsService\";\r\nimport Features from \"../constants/features\";\r\nimport {scaleToken} from \"./tokenService\";\r\n\r\nconst flightItems = [\"Take Flight\", \"Land\", \"Fly Higher\", \"Fly Lower\"];\r\n\r\nexport async function parseChatForFlight(chatMessage, messageText, chatData) {\r\n    const itemUsed = await getItemFromChatMessage(chatMessage);\r\n    if(!itemUsed) return;\r\n    \r\n    const command = flightItems.find(flightItem => itemUsed.name === flightItem);\r\n    if(!command) return;\r\n       \r\n    const initiatingActorToken = await getCurrentSceneTokenFromChatMessage(chatMessage);\r\n    const controlledToken = canvas.tokens.controlled[0];\r\n    \r\n    if(game.user.isGM) {\r\n        if(!controlledToken) {\r\n            ui.notifications.warn(\"Please select a token to initiate flight on.\");\r\n        }\r\n        await handleFlightCommand(command, controlledToken.actor, controlledToken);\r\n        return;\r\n    }\r\n    \r\n\r\n    if(initiatingActorToken.actorId !== controlledToken.document.actorid) {\r\n        ui.notifications.warn(\"Please select your token to use this action.\");\r\n        return;\r\n    }\r\n    \r\n    await handleFlightCommand(command, controlledToken.actor, controlledToken);    \r\n}\r\n\r\nasync function updateTokenElevation(token, elevation) {    \r\n    if(token.document.elevation === elevation) return;\r\n    await token.document.update({ elevation: elevation });\r\n}\r\n\r\nasync function updateFlyingStatus(actor, status) {\r\n    const acAdjustment = getAcAdjustmentValue();\r\n    const effectData = {\r\n        label: \"Flying\",\r\n        icon: Features.FlyingImage,\r\n        changes: [\r\n            { key: \"system.attributes.ac.bonus\", mode: CONST.ACTIVE_EFFECT_MODES.ADD, value: acAdjustment }\r\n        ],\r\n        statuses: [\r\n            \"flying\"\r\n        ],\r\n        origin: actor.uuid,\r\n    };\r\n    \r\n\r\n    if (status) {\r\n        await addEffectIfMissing(actor, effectData);\r\n    } else {\r\n        await deleteEffectIfExists(actor, effectData.label);\r\n    }\r\n}\r\n\r\nasync function handleFlightCommand(command, actor, token) {\r\n    const incrementValue = getIncrementValue();\r\n    const maxHeight = getMaxFlightHeightValue();\r\n    const currentElevation = token.document.elevation;\r\n    switch (command) {\r\n        case \"Take Flight\":\r\n            await updateFlyingStatus(actor, true);\r\n            await updateTokenElevation(token, incrementValue);\r\n            await scaleToken(token, incrementValue);\r\n            break;\r\n        case \"Land\":\r\n            if(!await hasEffect(actor, \"Flying\")) return;\r\n            await updateFlyingStatus(actor, false);\r\n            await updateTokenElevation(token, 0);\r\n            await scaleToken(token, 0);\r\n            break;\r\n        case \"Fly Higher\":\r\n            if(!await hasEffect(actor, \"Flying\")) return;\r\n            const newElevationUp = Math.min((currentElevation || 0) + incrementValue, maxHeight);\r\n            await updateTokenElevation(token, newElevationUp);\r\n            await scaleToken(token, newElevationUp);\r\n            return false;\r\n        case \"Fly Lower\":\r\n            if(!await hasEffect(actor, \"Flying\")) return;\r\n            const newElevationDown = Math.max((currentElevation || 0) - incrementValue, incrementValue);\r\n            await updateTokenElevation(token, newElevationDown);\r\n            await scaleToken(token, newElevationDown);\r\n            return false;\r\n        default:\r\n            console.warn(`Unknown flight command: ${command}`);\r\n    }\r\n}","import Features from \"../constants/features\";\r\n\r\nexport const flightFeatures = [\r\n    {\r\n        name: Features.FlyingLabel,\r\n        type: \"feat\",\r\n        system: {\r\n            description: {\r\n                \"value\": \"<p>Take flight, allowing you to see over objects and move over the battlefield</p>\",\r\n                \"chat\": \"<p>Take flight, allowing you to see over objects and move over the battlefield</p>\"\r\n            },\r\n            source: {},\r\n            activation: {\r\n                type: \"action\",\r\n                cost: 1,\r\n                condition: \"\"\r\n            },\r\n            duration: {\r\n                value: \"\",\r\n                units: \"\"\r\n            },\r\n            cover: null,\r\n            crewed: false,\r\n            target: {\r\n                value: \"\",\r\n                width: null,\r\n                units: \"\",\r\n                type: \"self\",\r\n                prompt: true\r\n            },\r\n            range: {\r\n                value: null,\r\n                long: null,\r\n                units: \"self\"\r\n            },\r\n            uses: {\r\n                value: null,\r\n                max: \"\",\r\n                per: null,\r\n                recovery: \"\",\r\n                prompt: true\r\n            },\r\n            consume: {\r\n                type: \"\",\r\n                target: null,\r\n                amount: null,\r\n                scale: false\r\n            },\r\n            ability: \"none\",\r\n            actionType: \"util\",\r\n            attack: {\r\n                bonus: \"\",\r\n                flat: false\r\n            },\r\n            chatFlavor: \"\",\r\n            critical: {\r\n                threshold: null,\r\n                damage: \"\"\r\n            },\r\n            damage: {\r\n                parts: [],\r\n                versatile: \"\"\r\n            },\r\n            enchantment: null,\r\n            formula: \"\",\r\n            save: {\r\n                ability: \"\",\r\n                dc: null,\r\n                scaling: \"spell\"\r\n            },\r\n            summons: null,\r\n            type: {\r\n                value: \"race\",\r\n                subtype: \"\"\r\n            },\r\n            prerequisites: {\r\n                \"level\": null\r\n            },\r\n            properties: [],\r\n            requirements: \"\",\r\n            recharge: {\r\n                value: null,\r\n                charged: false\r\n            }\r\n        },\r\n        img: Features.FlyingImage,\r\n        effects: []\r\n    },\r\n    {\r\n        name: Features.LandLabel,\r\n        type: \"feat\",\r\n        system: {\r\n            description: {\r\n                \"value\": \"<p>Land on the ground, removing flying status.</p>\",\r\n                \"chat\": \"<p>Land on the ground, removing flying status.</p>\"\r\n            },\r\n            source: {},\r\n            activation: {\r\n            },\r\n            duration: {\r\n                value: \"\",\r\n                units: \"\"\r\n            },\r\n            cover: null,\r\n            crewed: false,\r\n            target: {\r\n                value: \"\",\r\n                width: null,\r\n                units: \"\",\r\n                type: \"self\",\r\n                prompt: true\r\n            },\r\n            range: {\r\n                value: null,\r\n                long: null,\r\n                units: \"self\"\r\n            },\r\n            uses: {\r\n                value: null,\r\n                max: \"\",\r\n                per: null,\r\n                recovery: \"\",\r\n                prompt: true\r\n            },\r\n            consume: {\r\n                type: \"\",\r\n                target: null,\r\n                amount: null,\r\n                scale: false\r\n            },\r\n            ability: \"none\",\r\n            actionType: \"util\",\r\n            attack: {\r\n                bonus: \"\",\r\n                flat: false\r\n            },\r\n            chatFlavor: \"\",\r\n            critical: {\r\n                threshold: null,\r\n                damage: \"\"\r\n            },\r\n            damage: {\r\n                parts: [],\r\n                versatile: \"\"\r\n            },\r\n            enchantment: null,\r\n            formula: \"\",\r\n            save: {\r\n                ability: \"\",\r\n                dc: null,\r\n                scaling: \"spell\"\r\n            },\r\n            summons: null,\r\n            type: {\r\n                value: \"race\",\r\n                subtype: \"\"\r\n            },\r\n            prerequisites: {\r\n                \"level\": null\r\n            },\r\n            properties: [],\r\n            requirements: \"\",\r\n            recharge: {\r\n                value: null,\r\n                charged: false\r\n            }\r\n        },\r\n        img: Features.LandImage,\r\n        effects: []\r\n    },\r\n    {\r\n        name: Features.RaiseLabel,\r\n        type: \"feat\",\r\n        system: {\r\n            description: {\r\n                \"value\": \"<p>Increase the height at which you are flying</p>\",\r\n                \"chat\": \"<p>Increase the height at which you are flying</p>\"\r\n            },\r\n            source: {},\r\n            activation: {\r\n            },\r\n            duration: {\r\n                value: \"\",\r\n                units: \"\"\r\n            },\r\n            cover: null,\r\n            crewed: false,\r\n            target: {\r\n                value: \"\",\r\n                width: null,\r\n                units: \"\",\r\n                type: \"self\",\r\n                prompt: true\r\n            },\r\n            range: {\r\n                value: null,\r\n                long: null,\r\n                units: \"self\"\r\n            },\r\n            uses: {\r\n                value: null,\r\n                max: \"\",\r\n                per: null,\r\n                recovery: \"\",\r\n                prompt: true\r\n            },\r\n            consume: {\r\n                type: \"\",\r\n                target: null,\r\n                amount: null,\r\n                scale: false\r\n            },\r\n            ability: \"none\",\r\n            actionType: \"util\",\r\n            attack: {\r\n                bonus: \"\",\r\n                flat: false\r\n            },\r\n            chatFlavor: \"\",\r\n            critical: {\r\n                threshold: null,\r\n                damage: \"\"\r\n            },\r\n            damage: {\r\n                parts: [],\r\n                versatile: \"\"\r\n            },\r\n            enchantment: null,\r\n            formula: \"\",\r\n            save: {\r\n                ability: \"\",\r\n                dc: null,\r\n                scaling: \"spell\"\r\n            },\r\n            summons: null,\r\n            type: {\r\n                value: \"race\",\r\n                subtype: \"\"\r\n            },\r\n            prerequisites: {\r\n                \"level\": null\r\n            },\r\n            properties: [],\r\n            requirements: \"\",\r\n            recharge: {\r\n                value: null,\r\n                charged: false\r\n            }\r\n        },\r\n        img: Features.RaiseImage,\r\n        effects: []\r\n    },\r\n    {\r\n        name: Features.LowerLabel,\r\n        type: \"feat\",\r\n        system: {\r\n            description: {\r\n                \"value\": \"<p>Decrease the height at which you are flying</p>\",\r\n                \"chat\": \"<p>Decrease the height at which you are flying</p>\"\r\n            },\r\n            source: {},\r\n            activation: {\r\n            },\r\n            duration: {\r\n                value: \"\",\r\n                units: \"\"\r\n            },\r\n            cover: null,\r\n            crewed: false,\r\n            target: {\r\n                value: \"\",\r\n                width: null,\r\n                units: \"\",\r\n                type: \"self\",\r\n                prompt: true\r\n            },\r\n            range: {\r\n                value: null,\r\n                long: null,\r\n                units: \"self\"\r\n            },\r\n            uses: {\r\n                value: null,\r\n                max: \"\",\r\n                per: null,\r\n                recovery: \"\",\r\n                prompt: true\r\n            },\r\n            consume: {\r\n                type: \"\",\r\n                target: null,\r\n                amount: null,\r\n                scale: false\r\n            },\r\n            ability: \"none\",\r\n            actionType: \"util\",\r\n            attack: {\r\n                bonus: \"\",\r\n                flat: false\r\n            },\r\n            chatFlavor: \"\",\r\n            critical: {\r\n                threshold: null,\r\n                damage: \"\"\r\n            },\r\n            damage: {\r\n                parts: [],\r\n                versatile: \"\"\r\n            },\r\n            enchantment: null,\r\n            formula: \"\",\r\n            save: {\r\n                ability: \"\",\r\n                dc: null,\r\n                scaling: \"spell\"\r\n            },\r\n            summons: null,\r\n            type: {\r\n                value: \"race\",\r\n                subtype: \"\"\r\n            },\r\n            prerequisites: {\r\n                \"level\": null\r\n            },\r\n            properties: [],\r\n            requirements: \"\",\r\n            recharge: {\r\n                value: null,\r\n                charged: false\r\n            }\r\n        },\r\n        img: Features.LowerImage,\r\n        effects: []\r\n    }\r\n];","import { flightFeatures } from '../compendium/flightFeatures.js';\r\nimport { moduleData } from \"../constants/moduleData\";\r\n\r\nexport async function addFlightFeaturesToCompendium() {\r\n    const packName = `${moduleData.moduleName}.${moduleData.featurePack}`;\r\n    const pack = game.packs.find(p => p.metadata.id === packName);\r\n    if (!pack) {\r\n        throw new Error(\"Compendium flight-features not found\");\r\n    }\r\n\r\n    await addManyToPack(pack, flightFeatures, \"item\");\r\n}\r\n\r\nasync function addManyToPack(pack, itemCollection) {\r\n    pack.configure({ locked: false });\r\n\r\n    for (const item of itemCollection) {\r\n        const existingItem = pack.index.find((i) => i.name === item.name);\r\n        if (!existingItem) {\r\n            let addedItem;\r\n            addedItem = await Item.create(item, { pack: pack.metadata.id });           \r\n            console.log(`Macro '${addedItem.name}' added to compendium ${pack.metadata.name}`);\r\n        }\r\n    }\r\n\r\n    pack.configure({ locked: true });\r\n}","import { parseChatForFlight } from './services/flightService.js';\r\nimport { addFlightFeaturesToCompendium } from \"./services/dataService.js\";\r\nimport {registerSettings} from \"./services/settingsService\";\r\nimport Features from \"./constants/features\";\r\n\r\nHooks.once(\"init\", async () => {\r\n    await registerSettings();\r\n    console.log(\"Phoenix Modules - Flight is installed!\");\r\n});\r\n\r\n\r\nHooks.once('ready', async () => {\r\n    await addFlightFeaturesToCompendium();\r\n});\r\n\r\n\r\nHooks.on(\"preCreateChatMessage\", (chatMessage, messageText, chatData) => {\r\n    parseChatForFlight(chatMessage, messageText, chatData);\r\n    const itemNamesToBlock = [Features.RaiseLabel, Features.LowerLabel];\r\n    const item = itemNamesToBlock.find(item => chatMessage.content.includes(item));\r\n    if (item) {\r\n        return false;\r\n    }\r\n});"],"names":["getItemFromChatMessage","chatMessage","_a","_b","_c","itemId","getCurrentSceneTokenFromChatMessage","tokenId","searchResult","addEffectIfMissing","actor","effectData","x","deleteEffectIfExists","effectName","existingEffect","hasEffect","moduleData","Settings","Images","Features","registerSettings","value","getMaxFlightHeightValue","getIncrementValue","getAcAdjustmentValue","scaleToken","token","elevation","scaleValue","flightItems","parseChatForFlight","messageText","chatData","itemUsed","command","flightItem","initiatingActorToken","controlledToken","handleFlightCommand","updateTokenElevation","updateFlyingStatus","status","acAdjustment","incrementValue","maxHeight","currentElevation","newElevationUp","newElevationDown","flightFeatures","addFlightFeaturesToCompendium","packName","pack","p","addManyToPack","itemCollection","item","i","addedItem"],"mappings":"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"}